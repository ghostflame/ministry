var date = require( './date.js' );
var prtf = require( './printf.js' );
var aoa  = require( './arrayOfArrays.js' );
require( './hash.js' );
require( './json.js' );
require( './maths.js' );

var types = {
    string: {
        output:     'toString',
        parser:     null,
    },
    msString: {
        output:     'toMsString',
        parser:     null,
    },
    openbet: {
        output:     'toOpenbet',
        parser:     'parseOpenbet',
    },
    openbetHour: {
        output:     'toOpenbetHour',
        parser:     null,
    },
    lamp: {
        output:     'toLamp',
        parser:     'parseLamp',
    },
    fog: {
        output:     'toFog',
        parser:     'parseFog',
    },
};

var things = [
    [ 1, 1000, 1000000 ],
    [ 2, 2000, 2000000 ],
    [ 3, 3000, 3000000 ],
    [ 4,       4000000 ],
];


console.log( 'Date output/parse types.' );
var fmt = ' %-15s:   %6s   %s';

for( var key in types ) {

    var d = new Date( );
    var t = types[key];

    t.out = d[t.output]( )

    prtf.printf( fmt, [ key, 'out', t.out ] );

    if( t.parser ) {
        t.in = d[t.parser]( t.out );
        d.setTime( t.in );
        t.reout = d[t.output]( );
        fmt.printf( [ key, 'in/out', t.reout ] );
        fmt.printf( [ key, 'hash', (t.reout.hashVal( ) % 999929).toString( ) ] );
    }
}

var a = { };
var b = { };

a.foo = "foo";
a.bar = "bar";

b.bar = "bar";
b.foo = "foo";

var as = JSON.stringify( a );
var bs = JSON.stringify( b );
var an = JSON.makeNice( a );
var bn = JSON.makeNice( b );

console.log( "JSON tests\n" );
console.log( as, bs );
console.log( bn );
console.log( ( an === bn ) );


var arr = [ 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 1.7 ];


var a = arr.reduce(function(a, b) { return a + b })
var b = Math.ksum( arr );

console.log( "Sum: " + a + "   Ksum: " + b );

// bit of a hack really
console.log( [ 0, 1, 2, 2.5 ].map( function( k ) { return k.plural( 'hack' ); } ).join( ', ' ) );


// give things the new properties
aoa.bless( things );

console.log( "Things are not uniform, so   ", things.aoa_uniform( ) );
console.log( "Things first are a sequence: ", things.aoa_first( ) );
console.log( "Things last are as well:     ", things.aoa_last( ) );
console.log( "Things have uneven middles:  ", things.aoa_vertical( 1 ) );

var d = new Date( );

console.log( 'Day of the year is:     ' + d.getDay( ) );
console.log( 'The basic ISO week is:  ' + d.getIsoWeek( ) );
console.log( 'The offset ISO week is: ' + d.getIsoWeek( true ) );


console.log( 'Decimal depth test: %%4.f -> %4.f'.sprintf( [ 12.3456 ] ) );

